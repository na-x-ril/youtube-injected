const FILTER_CONFIG={ytInitialData:["videoPrimaryInfoRenderer","!videoPrimaryInfoRenderer.videoActions","!videoPrimaryInfoRenderer.updatedMetadataEndpoint","videoSecondaryInfoRenderer.owner","!videoSecondaryInfoRenderer.owner.videoOwnerRenderer.membershipButton","!trackingParams","!clickTrackingParams","!miniplayer","!contextParams","!dislikeButtonViewModel","!segmentedLikeDislikeButtonViewModel.dislikeButtonViewModel"],ytInitialPlayerResponse:["videoDetails","playabilityStatus","!playabilityStatus.miniplayer","!playabilityStatus.contextParams","playerConfig","microformat","!miniplayer","!contextParams","!trackingParams","!clickTrackingParams","!videoDetails.keywords","!playabilityStatus.reason","!playerMicroformatRenderer.availableCountries"]};window.trustedTypes&&window.trustedTypes.createPolicy&&window.trustedTypes.createPolicy("default",{createHTML:e=>e,createScriptURL:e=>e,createScript:e=>e});const SUPPORTED_LANGUAGES=[{id:"AF",name:"Afghanistan"},{id:"AX",name:"Åland Islands"},{id:"AL",name:"Albania"},{id:"DZ",name:"Algeria"},{id:"AS",name:"American Samoa"},{id:"AD",name:"Andorra"},{id:"AO",name:"Angola"},{id:"AI",name:"Anguilla"},{id:"AQ",name:"Antarctica"},{id:"AG",name:"Antigua And Barbuda"},{id:"AR",name:"Argentina"},{id:"AM",name:"Armenia"},{id:"AW",name:"Aruba"},{id:"AC",name:"Ascension Island"},{id:"AU",name:"Australia"},{id:"AT",name:"Austria"},{id:"AZ",name:"Azerbaijan"},{id:"BS",name:"Bahamas"},{id:"BH",name:"Bahrain"},{id:"BD",name:"Bangladesh"},{id:"BB",name:"Barbados"},{id:"BY",name:"Belarus"},{id:"BE",name:"Belgium"},{id:"BZ",name:"Belize"},{id:"BJ",name:"Benin"},{id:"BM",name:"Bermuda"},{id:"BT",name:"Bhutan"},{id:"BO",name:"Bolivia"},{id:"BA",name:"Bosnia And Herzegovina"},{id:"BW",name:"Botswana"},{id:"BV",name:"Bouvet Island"},{id:"BR",name:"Brazil"},{id:"IO",name:"British Indian Ocean Territory"},{id:"VG",name:"British Virgin Islands"},{id:"BN",name:"Brunei Darussalam"},{id:"BG",name:"Bulgaria"},{id:"BF",name:"Burkina Faso"},{id:"MM",name:"Burma"},{id:"BI",name:"Burundi"},{id:"CI",name:"CÔte D'ivoire"},{id:"KH",name:"Cambodia"},{id:"CM",name:"Cameroon"},{id:"CA",name:"Canada"},{id:"CV",name:"Cape Verde"},{id:"KY",name:"Cayman Islands"},{id:"CF",name:"Central African Republic"},{id:"TD",name:"Chad"},{id:"CL",name:"Chile"},{id:"CN",name:"China"},{id:"CX",name:"Christmas Island"},{id:"CC",name:"Cocos (keeling) Islands"},{id:"CO",name:"Colombia"},{id:"KM",name:"Comoros"},{id:"CG",name:"Congo"},{id:"CD",name:"Congo, The Democratic Republic Of The"},{id:"CK",name:"Cook Islands"},{id:"CR",name:"Costa Rica"},{id:"HR",name:"Croatia"},{id:"CU",name:"Cuba"},{id:"CY",name:"Cyprus"},{id:"CZ",name:"Czech Republic"},{id:"DK",name:"Denmark"},{id:"DJ",name:"Djibouti"},{id:"DM",name:"Dominica"},{id:"DO",name:"Dominican Republic"},{id:"EC",name:"Ecuador"},{id:"EG",name:"Egypt"},{id:"SV",name:"El Salvador"},{id:"GQ",name:"Equatorial Guinea"},{id:"ER",name:"Eritrea"},{id:"EE",name:"Estonia"},{id:"ET",name:"Ethiopia"},{id:"FK",name:"Falkland Islands (malvinas)"},{id:"FO",name:"Faroe Islands"},{id:"FJ",name:"Fiji"},{id:"FI",name:"Finland"},{id:"FR",name:"France"},{id:"GF",name:"French Guiana"},{id:"PF",name:"French Polynesia"},{id:"TF",name:"French Southern Territories"},{id:"GA",name:"Gabon"},{id:"GM",name:"Gambia"},{id:"GE",name:"Georgia"},{id:"DE",name:"Germany"},{id:"GH",name:"Ghana"},{id:"GI",name:"Gibraltar"},{id:"GR",name:"Greece"},{id:"GL",name:"Greenland"},{id:"GD",name:"Grenada"},{id:"GP",name:"Guadeloupe"},{id:"GU",name:"Guam"},{id:"GT",name:"Guatemala"},{id:"GG",name:"Guernsey"},{id:"GN",name:"Guinea"},{id:"GW",name:"Guinea-bissau"},{id:"GY",name:"Guyana"},{id:"HT",name:"Haiti"},{id:"HM",name:"Heard Island And Mcdonald Islands"},{id:"VA",name:"Holy See (vatican City State)"},{id:"HN",name:"Honduras"},{id:"HK",name:"Hong Kong"},{id:"HU",name:"Hungary"},{id:"IS",name:"Iceland"},{id:"IN",name:"India"},{id:"ID",name:"Indonesia"},{id:"IR",name:"Iran"},{id:"IQ",name:"Iraq"},{id:"IE",name:"Ireland"},{id:"IM",name:"Isle Of Man"},{id:"IL",name:"Israel"},{id:"IT",name:"Italy"},{id:"JM",name:"Jamaica"},{id:"JP",name:"Japan"},{id:"JE",name:"Jersey"},{id:"JO",name:"Jordan"},{id:"KZ",name:"Kazakhstan"},{id:"KE",name:"Kenya"},{id:"KI",name:"Kiribati"},{id:"KR",name:"Korea"},{id:"KW",name:"Kuwait"},{id:"KG",name:"Kyrgyzstan"},{id:"LA",name:"Lao People's Democratic Republic"},{id:"LV",name:"Latvia"},{id:"LB",name:"Lebanon"},{id:"LS",name:"Lesotho"},{id:"LR",name:"Liberia"},{id:"LY",name:"Libya"},{id:"LI",name:"Liechtenstein"},{id:"LT",name:"Lithuania"},{id:"LU",name:"Luxembourg"},{id:"MO",name:"Macao"},{id:"MK",name:"Macedonia"},{id:"MG",name:"Madagascar"},{id:"MW",name:"Malawi"},{id:"MY",name:"Malaysia"},{id:"MV",name:"Maldives"},{id:"ML",name:"Mali"},{id:"MT",name:"Malta"},{id:"MH",name:"Marshall Islands"},{id:"MQ",name:"Martinique"},{id:"MR",name:"Mauritania"},{id:"MU",name:"Mauritius"},{id:"YT",name:"Mayotte"},{id:"MX",name:"Mexico"},{id:"FM",name:"Micronesia, Federated States Of"},{id:"MD",name:"Moldova"},{id:"MC",name:"Monaco"},{id:"MN",name:"Mongolia"},{id:"ME",name:"Montenegro"},{id:"MS",name:"Montserrat"},{id:"MA",name:"Morocco"},{id:"MZ",name:"Mozambique"},{id:"NA",name:"Namibia"},{id:"NR",name:"Nauru"},{id:"NP",name:"Nepal"},{id:"NL",name:"Netherlands"},{id:"AN",name:"Netherlands Antilles"},{id:"NC",name:"New Caledonia"},{id:"NZ",name:"New Zealand"},{id:"NI",name:"Nicaragua"},{id:"NE",name:"Niger"},{id:"NG",name:"Nigeria"},{id:"NU",name:"Niue"},{id:"NF",name:"Norfolk Island"},{id:"MP",name:"Northern Mariana Islands"},{id:"NO",name:"Norway"},{id:"OM",name:"Oman"},{id:"PK",name:"Pakistan"},{id:"PW",name:"Palau"},{id:"PS",name:"Palestinian Territory"},{id:"PA",name:"Panama"},{id:"PG",name:"Papua New Guinea"},{id:"PY",name:"Paraguay"},{id:"PE",name:"Peru"},{id:"PH",name:"Philippines"},{id:"PN",name:"Pitcairn"},{id:"PL",name:"Poland"},{id:"PT",name:"Portugal"},{id:"PR",name:"Puerto Rico"},{id:"QA",name:"Qatar"},{id:"RE",name:"Réunion"},{id:"RO",name:"Romania"},{id:"RU",name:"Russian Federation"},{id:"RW",name:"Rwanda"},{id:"BL",name:"Saint Barthélemy"},{id:"SH",name:"Saint Helena"},{id:"KN",name:"Saint Kitts And Nevis"},{id:"LC",name:"Saint Lucia"},{id:"MF",name:"Saint Martin"},{id:"PM",name:"Saint Pierre And Miquelon"},{id:"VC",name:"Saint Vincent And The Grenadines"},{id:"WS",name:"Samoa"},{id:"SM",name:"San Marino"},{id:"ST",name:"Sao Tome And Principe"},{id:"SA",name:"Saudi Arabia"},{id:"SN",name:"Senegal"},{id:"RS",name:"Serbia"},{id:"SC",name:"Seychelles"},{id:"SL",name:"Sierra Leone"},{id:"SG",name:"Singapore"},{id:"SK",name:"Slovakia"},{id:"SI",name:"Slovenia"},{id:"SB",name:"Solomon Islands"},{id:"SO",name:"Somalia"},{id:"ZA",name:"South Africa"},{id:"GS",name:"South Georgia And The South Sandwich Islands"},{id:"ES",name:"Spain"},{id:"LK",name:"Sri Lanka"},{id:"SD",name:"Sudan"},{id:"SR",name:"Suriname"},{id:"SJ",name:"Svalbard And Jan Mayen"},{id:"SZ",name:"Swaziland"},{id:"SE",name:"Sweden"},{id:"CH",name:"Switzerland"},{id:"SY",name:"Syrian Arab Republic"},{id:"TW",name:"Taiwan, Province Of China"},{id:"TJ",name:"Tajikistan"},{id:"TZ",name:"Tanzania, United Republic Of"},{id:"TH",name:"Thailand"},{id:"TL",name:"Timor-leste"},{id:"TG",name:"Togo"},{id:"TK",name:"Tokelau"},{id:"TO",name:"Tonga"},{id:"TT",name:"Trinidad And Tobago"},{id:"TN",name:"Tunisia"},{id:"TR",name:"Turkey"},{id:"TM",name:"Turkmenistan"},{id:"TC",name:"Turks And Caicos Islands"},{id:"TV",name:"Tuvalu"},{id:"UG",name:"Uganda"},{id:"UA",name:"Ukraine"},{id:"AE",name:"United Arab Emirates"},{id:"GB",name:"United Kingdom"},{id:"US",name:"United States"},{id:"UM",name:"United States Minor Outlying Islands"},{id:"UY",name:"Uruguay"},{id:"UZ",name:"Uzbekistan"},{id:"VU",name:"Vanuatu"},{id:"VE",name:"Venezuela"},{id:"VN",name:"Viet Nam"},{id:"VI",name:"Virgin Islands, U.s."},{id:"WF",name:"Wallis And Futuna"},{id:"EH",name:"Western Sahara"},{id:"YE",name:"Yemen"},{id:"ZM",name:"Zambia"},{id:"ZW",name:"Zimbabwe"}];class YouTubeUtils{static formatDateTime(e){try{const t=new Date(e);return isNaN(t.getTime())?null:t.toLocaleString("id-ID",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit",timeZoneName:"short"})}catch(t){return console.warn(`Failed to format date: ${e}`,t),null}}static getElement(e){return document.querySelector(e)}static getElements(e){return document.querySelectorAll(e)}static getCurrentVideoId(){return new URL(location.href).searchParams.get("v")}static getFormattedTime(e){const t=Math.floor(e/3600),n=Math.floor(e%3600/60),i=Math.floor(e%60);return`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}static getSecondsFromTime(e){const t=e.split(":").map(Number);if(3!==t.length)return NaN;const[n,i,a]=t;return isNaN(n)||isNaN(i)||isNaN(a)?NaN:3600*n+60*i+a}static getIsValidTimeFormat(e){return/^\d{2}:\d{2}:\d{2}$/.test(e)}static getIsValidSegmentData({startTime:e,endTime:t,category:n}){return!isNaN(e)&&!isNaN(t)&&e<t&&"string"==typeof n&&n.length>0}static getRelativeDateText(e){const t=e.match(/^(\d{1,2}) (\w{3,}) (\d{4})$/);if(!t)return e;const[n,i,a,s]=t,o={Jan:0,Feb:1,Mar:2,Apr:3,Mei:4,Jun:5,Jul:6,Agu:7,Sep:8,Okt:9,Nov:10,Des:11}[a];if(void 0===o)return e;const r=new Date(s,o,i);r.setHours(0,0,0,0);const l=new Date;l.setHours(0,0,0,0);const d=Math.floor((l-r)/864e5);return d<0?"Tanggal di masa depan":0===d?"Hari ini":`${d} hari yang lalu`}static wait(e){return new Promise(t=>setTimeout(t,e))}static waitForElement(e,t=1e4){return new Promise((n,i)=>{const a=()=>{const t=this.getElement(e);t?n(t):requestAnimationFrame(a)};a(),t&&setTimeout(()=>{this.getElement(e)||i(new Error(`Timeout waiting for element: ${e}`))},t)})}static waitForVideoData(e,t=1e4){return new Promise((n,i)=>{const a=()=>{const t=this.getElement(e);t&&t.readyState>=2?n(t):requestAnimationFrame(a)};a(),t&&setTimeout(()=>{this.getElement(e)||i(new Error(`Timeout waiting for element: ${e}`))},t)})}static getVideoElement(){return YouTubeUtils.getElement("video")}static getVideoDuration(){const e=this.getVideoElement();return e?e.duration:null}static getGeneratedUserID(){const e="0123456789abcdef";let t="";for(let n=0;n<30;n++)t+=e[Math.floor(16*Math.random())];return t}static getOrCreateUserID(){const e="sponsorblock_userid";let t=localStorage.getItem(e);return t||(t=this.getGeneratedUserID(),localStorage.setItem(e,t)),t}}class VideoManager{constructor(){this.audioNode=null,this.isAudioNodeCreated=!1,this.lastLoggedViewCount=null,this.latestFetchedData=null,this.countdownInterval=null,this.loopState=JSON.parse(localStorage.getItem("loopState")||"false"),this.isBassBoosted=JSON.parse(localStorage.getItem("bassBoost")||"false"),this.defaultSubtitle=localStorage.getItem("defaultSubtitleValue")||"id"}async fetchVideoData(e,t){try{const n=await fetch(window.location.href),i=await n.text(),a=await this.getCombinedData(i);if(a){this.latestFetchedData=a;const{initialData:n,playerResponse:i}=a,s=this.extractVideoInfo(n,i,e);s.isUpcoming&&s.scheduledStartTime&&this.startCountdown(s.scheduledStartTime),await this.applyResumePlayback(n),this.displayData(s,t)}}catch(t){console.error(`Error fetching video data for [${e}]:`,t)}}async monitorResolutionChange(){const e=await YouTubeUtils.waitForElement("#movie_player");if(!e)return void console.warn("Player element not found");const t=()=>new Promise(t=>{let n=e.getPlaybackQuality();const i=()=>{const a=e.getPlaybackQuality();if(a!==n){n=a;const i=e.getAvailableQualityLevels();console.log(`Quality changed to: ${a}, Available qualities: ${i}`),this.showNotification(`Resolution changed to ${a}`,"success"),localStorage.setItem("resolution",a),t(a)}else requestAnimationFrame(i)};i()});(async()=>{for(;;)try{const e=await t();console.log(`Detected quality: ${e}`),await YouTubeUtils.wait(100)}catch(e){console.error("Error in monitorResolutionChange:",e),this.showNotification("Error monitoring resolution change","error");break}})()}async setHighestResolution(){const e=await YouTubeUtils.waitForElement("#movie_player");if(!e)return void requestAnimationFrame(()=>this.setHighestResolution());await YouTubeUtils.wait(200);const t=localStorage.getItem("resolution"),n=e.getAvailableQualityLevels(),i=n.includes(t)?t:n[0];e.setPlaybackQualityRange(i),e.setPlaybackQuality(i),console.log(`Quality set to ${i}`),this.showNotification(`Quality set to ${i}`,"success")}applyVideoState(){const e=YouTubeUtils.getElement("#movie_player"),t=new URLSearchParams(location.search).has("list");e&&(t?e.setLoop(this.loopState):e.setLoopVideo(this.loopState))}async applySubtitleState(){const e=await YouTubeUtils.waitForElement("#movie_player");if(e&&this.defaultSubtitle){if(!e.setOption("captions","track",{languageCode:this.defaultSubtitle})){e.setOption("cc","track",{languageCode:this.defaultSubtitle})||(this.showNotification(`Caption ${this.defaultSubtitle} is unavailable.`,"error"),console.log(`Caption ${this.defaultSubtitle} is unavailable. Displaying default caption.`),e.toggleSubtitlesOn())}}}async applyBassBoostState(){const e=await YouTubeUtils.waitForElement("video");e&&(this.isBassBoosted&&!this.isAudioNodeCreated?(this.isAudioNodeCreated=this.createAudioNode(e),e.setAttribute("data-bass-boosted","true")):!this.isBassBoosted&&this.isAudioNodeCreated&&(this.destroyAudioNode(),e.removeAttribute("data-bass-boosted")))}createAudioNode(e){if(this.audioNode)return!0;if("true"===e.getAttribute("data-audio-processed"))return console.log("Video sudah memiliki audio node"),this.showNotification("Video sudah memiliki audio node","error"),!1;try{const t=new(window.AudioContext||window.webkitAudioContext),n=t.createMediaElementSource(e),i={inGain:t.createGain(),biquadFilter:t.createBiquadFilter(),outGain:t.createGain()};return[{frequency:31,gain:15},{frequency:62,gain:10},{frequency:125,gain:5},{frequency:250,gain:0},{frequency:500,gain:-5},{frequency:1e3,gain:-5},{frequency:2e3,gain:0},{frequency:4e3,gain:5},{frequency:8e3,gain:10},{frequency:16e3,gain:1}].forEach(({frequency:e,gain:n})=>{i.biquadFilter.frequency.setValueAtTime(e,t.currentTime),i.biquadFilter.Q.setValueAtTime(4,t.currentTime),i.biquadFilter.gain.setValueAtTime(n,t.currentTime)}),i.inGain.gain.setValueAtTime(.2,t.currentTime),i.outGain.gain.setValueAtTime(6.5,t.currentTime),n.connect(i.inGain).connect(i.biquadFilter).connect(i.outGain).connect(t.destination),console.log("Bass Boosted!"),this.showNotification("Bass Boosted","success"),this.audioNode=i,e.setAttribute("data-audio-processed","true"),e.setAttribute("data-audio-gain",i.outGain.gain.value),e.setAttribute("data-audio-filter","biquad"),!0}catch(e){return console.error("Error creating audio node:",e),this.showNotification("Failed to create audio node","error"),!1}}destroyAudioNode(){this.audioNode&&(this.audioNode.audioCtx.close(),this.audioNode=null,this.isAudioNodeCreated=!1)}extractVideoInfo(e,t,n){const i=e?.videoPrimaryInfoRenderer,a=e?.videoSecondaryInfoRenderer,s=i.viewCount?.videoViewCountRenderer,o=s?.isLive||!1,r=t?.videoDetails?.isUpcoming||!1,{upcomingDateText:l,scheduledStartTime:d}=this.getUpcomingDateText(t)||{},u="0"!==s?.originalViewCount?s?.originalViewCount.replace(".",""):t?.videoDetails?.viewCount||"0",c=a?.owner?.videoOwnerRenderer?.title?.runs?.[0]?.text||"",m=r&&l?l:r?i.dateText?.simpleText||"Tayang dalam waktu dekat":o?i.dateText?.simpleText||"Streaming dimulai baru saja":i.relativeDateText?.simpleText||i.dateText?.simpleText||"Dipublikasikan baru saja";return{videoId:n,title:i.title.runs[0].text,viewCount:u,channelTitle:c,dateText:m,isLive:o,isUpcoming:r,scheduledStartTime:d}}async getCombinedData(e){const t=(new DOMParser).parseFromString(e,"text/html"),n=Array.from(t.querySelectorAll("script")).find(e=>e.textContent.includes("ytInitialData")),i=Array.from(t.querySelectorAll("script")).find(e=>e.textContent.includes("ytInitialPlayerResponse"));if(!n||!i)return null;const a=this.extractJSON(n.textContent,"ytInitialData",FILTER_CONFIG.ytInitialData),s=this.extractJSON(i.textContent,"ytInitialPlayerResponse",FILTER_CONFIG.ytInitialPlayerResponse);return{videoId:YouTubeUtils.getCurrentVideoId(),initialData:a,playerResponse:s}}extractJSON(e,t,n){const i=[new RegExp(`(?:var |const |let |\\s*)${t}\\s*=[=]?\\s*(\\{[\\s\\S]*?\\})(?=\\s*;|\\s*<\\/script>|\\s*$)`,"s"),new RegExp(`window\\s*\\[\\s*["']${t}["']\\s*\\]\\s*=[=]?\\s*(\\{[\\s\\S]*?\\})(?=\\s*;|\\s*<\\/script>|\\s*$)`,"s"),new RegExp(`(?:\\s*)${t}\\s*=[=]?\\s*(\\{[\\s\\S]*?\\})\\s*(?=;|<\\/script>|$)`,"s"),new RegExp(`<script[^>]*>\\s*${t}\\s*=[=]?\\s*(\\{[\\s\\S]*?\\})\\s*(?:;|<\\/script>)`,"s")];for(let a=0;a<i.length;a++){const s=e.match(i[a]);if(s&&s[1])try{const e=JSON.parse(s[1]);return this.filterData(e,n)}catch(e){console.warn(`extractJSON - Failed to parse ${t} with pattern ${a+1}:`,e);continue}}throw new Error(`[${t}] not found`)}filterData(e,t){if(!e||"object"!=typeof e)return e;const n=t.filter(e=>!e.startsWith("!")).map(e=>e.split(".")),i=t.filter(e=>e.startsWith("!")).map(e=>e.slice(1).split(".")),a=i.filter(e=>1===e.length).map(e=>e[0]),s=(e,t,n)=>{let i=e;for(let e=0;e<t.length-1;e++){const n=t[e];i[n]=i[n]||(isNaN(t[e+1])?{}:[]),i=i[n]}i[t[t.length-1]]=n},o=(e,t,n={},i=[])=>{if(e&&"object"==typeof e)return Object.entries(e).forEach(([e,a])=>{const r=[...i,e];if(t.forEach(e=>{const t=e.join(".");if(r.join(".").endsWith(t)){const t=r.slice(-e.length);s(n,t,a)}}),(e.toLowerCase().includes("date")||e.toLowerCase().includes("time"))&&"string"==typeof a&&a.match(/^\d{4}-\d{2}-\d{2}T/)){const t=YouTubeUtils.formatDateTime(a);t&&s(n,[...i,`formatted${e.charAt(0).toUpperCase()+e.slice(1)}`],t);const o=YouTubeUtils.getRelativeDateText(a);o&&s(n,[...i,`relativeDateText${e.charAt(0).toUpperCase()+e.slice(1)}`],o)}(Array.isArray(a)||"object"==typeof a)&&o(a,t,n,r)}),n},r=(e,t,n)=>{e&&"object"==typeof e&&(n.forEach(t=>delete e[t]),t.filter(e=>e.length>1).forEach(t=>{let n=e;for(let e=0;e<t.length-1;e++){const i=t[e];if(!n[i])return;n=n[i]}delete n[t[t.length-1]]}),Object.values(e).forEach(e=>{(Array.isArray(e)||"object"==typeof e)&&r(e,t,n)}))};let l=o(e,n);return r(l,i,a),l}getUpcomingDateText(e){try{if(!e)return null;let t=null,n=null;if("LIVE_STREAM_OFFLINE"===e.playabilityStatus?.status&&e.playabilityStatus?.liveStreamability?.liveStreamabilityRenderer?.offlineSlate?.liveStreamOfflineSlateRenderer){const i=e.playabilityStatus.liveStreamability.liveStreamabilityRenderer.offlineSlate.liveStreamOfflineSlateRenderer;n=i.scheduledStartTime,t=n?this.getFormattedCountdown(parseInt(n)):i.mainText?.runs?.map(e=>e.text).join("")||null}return{upcomingDateText:t,scheduledStartTime:n}}catch(e){return console.error("getUpcomingDateText - Error:",e),{upcomingDateText:null,scheduledStartTime:null}}}getFormattedCountdown(e){const t=e-Math.floor(Date.now()/1e3);if(t<=0)return"Streaming akan dimulai sebentar lagi";const n=Math.floor(t/3600),i=Math.floor(t%3600/60);let a="Live dalam ";return n>0&&(a+=`${n} jam `),(i>0||n>0)&&(a+=`${i} menit `),a+=`${t%60} detik`,a}startCountdown(e){return this.countdownInterval&&clearInterval(this.countdownInterval),this.countdownInterval=setInterval(()=>{const t=this.getFormattedCountdown(parseInt(e));this.updateViewDisplay(this.lastLoggedViewCount,!1,!0,t)},1e3),()=>{this.countdownInterval&&(clearInterval(this.countdownInterval),this.countdownInterval=null)}}displayData(e,t){if(!e||!e.videoId)return;const{viewCount:n,dateText:i,channelTitle:a,isLive:s,isUpcoming:o,videoId:r}=e;this.latestFetchedData=e;const l=YouTubeUtils.getRelativeDateText(i);this.lastLoggedViewCount!==n&&(console.log(`Views for [${r}]: ${n}, ${l}`),this.lastLoggedViewCount=n);const d={viewCount:n,date:l,channelTitle:a,isLive:s,isUpcoming:o,videoId:r};void 0===t?this.addVideoIdAndViews(d):"refresh"===t&&(this.updateViewDisplay(n,s,o,l),console.log(`Refreshed views for [${r}]`),this.showNotification(`Refreshed views for ${r}`,"success"))}async addVideoIdAndViews(e){const{viewCount:t,date:n,channelTitle:i,isLive:a,isUpcoming:s,videoId:o}=e;try{await new Promise(e=>{"complete"===document.readyState?e():window.addEventListener("load",e)});const e=await Promise.race([YouTubeUtils.waitForElement("#above-the-fold > #top-row").then(e=>({element:e,type:"topRow"})),YouTubeUtils.waitForElement("#title > h1").then(e=>({element:e,type:"title"}))]);YouTubeUtils.getElement(".view-count-info")&&YouTubeUtils.getElement(".view-count-info").remove(),YouTubeUtils.getElement(".channelBy2")&&YouTubeUtils.getElement(".channelBy2").remove(),YouTubeUtils.getElement(".ytp-view-big-mode")&&YouTubeUtils.getElement(".ytp-view-big-mode").remove();const r=this.getFormattedViewCount(t,a,s),l=document.createElement("div");l.className="style-scope view-count-info",l.innerHTML=`\n        <h1 class="style-scope ytd-view-renderer">\n          <div id="viewcount-renderer" class="viewcount-renderer">\n            <span class="odometer" data-value="${t}" data-is-live="${a}"></span>\n            <span class="odometer-suffix">${r.substring(r.indexOf(" "))}</span>\n            <strong class="separator"> • </strong>\n            <span id="date_text" class="style-scope ytd-watch-metadata">${n}</span>\n          </div>\n        </h1>\n        <button id="refresh-view-count" class="style-scope refresh-vc" alt="Refresh viewCount" title="Refresh Viewcount">\n          <svg xmlns="http://www.w3.org/2000/svg" width="1.7em" height="1.7em" viewBox="0 0 24 24">\n            <path fill="white" d="M17.65 6.35A7.96 7.96 0 0 0 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0 1 12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"></path>\n          </svg>\n        </button>`,"topRow"===e.type?e.element.insertAdjacentElement("beforebegin",l):e.element.insertAdjacentElement("afterend",l),new Odometer({el:l.querySelector(".odometer"),value:parseInt(l.querySelector(".odometer").getAttribute("data-value")),theme:"minimal",locale:"id"}),YouTubeUtils.getElement("#refresh-view-count").addEventListener("click",()=>this.fetchVideoData(o,"refresh"));const d=await YouTubeUtils.waitForElement("div.ytp-title>div");if(d){const e=document.createElement("strong");e.className="channelBy2",e.textContent=`- ${i}`,d.appendChild(e);const n=await YouTubeUtils.waitForElement("#movie_player > div.ytp-chrome-top > div.ytp-chrome-top-buttons");if(n){const e=document.createElement("div");e.className="ytp-view-big-mode",e.setAttribute("aria-haspopup","true"),e.setAttribute("data-tooltip-opaque","true"),e.innerHTML=`\n            <div class="odometer" data-value="${t}" data-is-live="${a}"></div>\n            <svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" viewBox="0 0 24 24"><path fill="white" d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4s-4 1.79-4 4s1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v1c0 .55.45 1 1 1h14c.55 0 1-45 1-1v-1c0-2.66-5.33-4-8-4"/></svg>\n          `,n.insertAdjacentElement("beforebegin",e),new Odometer({el:e.querySelector(".odometer"),value:parseInt(e.querySelector(".odometer").getAttribute("data-value")),theme:"minimal",locale:"id"})}}this.showNotification(`Video ID and views for [${o}] added!`,"success")}catch(e){console.error(`Error in addVideoIdAndViews for [${o}]:`,e)}}updateViewDisplay(e,t,n,i){const a=YouTubeUtils.getElement("#viewcount-renderer .odometer"),s=YouTubeUtils.getElement("#viewcount-renderer .odometer-suffix"),o=YouTubeUtils.getElement("#date_text"),r=YouTubeUtils.getElement("#movie_player > div.ytp-chrome-top > div.ytp-view-big-mode .odometer");if(a){if(a.odometer.update(e),a.setAttribute("data-value",e),s){const i=this.getFormattedViewCount(e,t,n);s.textContent=i.substring(i.indexOf(" "))}o&&(o.textContent=i)}r&&(r.odometer.update(e),r.setAttribute("data-value",e))}getFormattedViewCount(e,t,n){let i=(e=parseInt(e,10)).toLocaleString("en-US");const a=[{threshold:1e12,suffix:" B"},{threshold:1e9,suffix:" M"},{threshold:1e6,suffix:" jt"},{threshold:1e3,suffix:" rb"}].find(({threshold:t})=>e>=t);if(a){i+=` (${(Math.floor(e/a.threshold*10)/10).toString().replace(".",",").replace(/,0$/,"")}${a.suffix})`}return i+=n?" menunggu":t?" sedang menonton":" x ditonton",i}async applyResumePlayback(e){if("/watch"!==location.pathname||e?.videoPrimaryInfoRenderer?.viewCount?.videoViewCountRenderer?.isLive)return;const t=YouTubeUtils.getCurrentVideoId(),n=localStorage.getItem(`yt_time_${t}`);if(n){const e=await YouTubeUtils.waitForElement("video"),i=await YouTubeUtils.waitForElement("#movie_player");e._resumeHandler&&e.removeEventListener("loadedmetadata",e._resumeHandler),e._resumeHandler=()=>{if(e.getAttribute("data-resumed")===t)return;let a=parseFloat(n);const s=e.duration;isNaN(a)||(a=Math.max(0,a-2),a<s-5&&(i.seekTo(a,!0),this.showNotification(`Resuming playback at ${YouTubeUtils.getFormattedTime(a)}`,"info"),e.setAttribute("data-resumed",t)))},e.addEventListener("loadedmetadata",e._resumeHandler)}}async savePlaybackPosition(){if(confirm(this.latestFetchedData?.videoPrimaryInfoRenderer?.viewCount?.videoViewCountRenderer),"/watch"===location.pathname&&!this.latestFetchedData?.videoPrimaryInfoRenderer?.viewCount?.videoViewCountRenderer?.isLive)try{const e=YouTubeUtils.getCurrentVideoId(),t=await YouTubeUtils.waitForElement("video");if(t&&!isNaN(t.currentTime)){const n=t.currentTime,i=t.duration;n>5&&n<i-5&&(localStorage.setItem(`yt_time_${e}`,n.toString()),this.showNotification(`Saved playback position (${YouTubeUtils.getFormattedTime(n)}) for video ${e}`,"success"))}}catch(e){console.error("Error saving video time:",e)}}showNotification(e,t="info"){const n=document.createElement("div");n.className=`segment-notification ${["info","success","warning","error"].includes(t)?t:"info"}`,n.textContent=e;let i=YouTubeUtils.getElement(".notification-container");i||(i=document.createElement("div"),i.className="notification-container",document.body.appendChild(i)),i.prepend(n),setTimeout(()=>n.classList.add("show"),100),setTimeout(()=>{n.classList.remove("show"),setTimeout(()=>n.remove(),300)},3e3)}}class SponsorSegmentManager{constructor(e,t){this.videoManager=e,this.uiManager=t,this.sponsorSegments=[],this.currentSponsorSegment=null,this.skipButton=null,this.skipSettings=this.loadSkipSettings(),this.pendingSegments=[],this.segmentStartTime=null}async initializeSponsorSkip(){const e=await YouTubeUtils.waitForElement("video");e.addEventListener("timeupdate",()=>{const t=e.currentTime,n=this.sponsorSegments.find(e=>t>=e.start&&t<e.end);n&&n!==this.currentSponsorSegment?(this.currentSponsorSegment=n,"auto"===this.skipSettings[n.type]?(e.currentTime=n.end,this.currentSponsorSegment=null):this.showSkipButton(e,n)):!n&&this.currentSponsorSegment&&(this.currentSponsorSegment=null,this.hideSkipButton())},{throttle:100}),e.addEventListener("loadedmetadata",()=>{this.highlightSponsorSegments()}),e.addEventListener("seeking",()=>{this.highlightSponsorSegments()}),document.addEventListener("keydown",t=>{"Enter"===t.key&&this.currentSponsorSegment&&this.skipCurrentSegment(e)}),this.fetchSponsorSegments(YouTubeUtils.getCurrentVideoId()),await this.addSubmitButton(),await this.setupSubmitSegmentListeners(this.uiManager)}loadSkipSettings(){try{const e=localStorage.getItem("skipSettings");return e?JSON.parse(e):{sponsor:"manual",selfpromo:"manual",interaction:"manual",intro:"manual",outro:"manual",preview:"manual",music_offtopic:"manual",filler:"manual"}}catch(e){return console.error("Error loading skip settings:",e),{sponsor:"manual",selfpromo:"manual",interaction:"manual",intro:"manual",outro:"manual",preview:"manual",music_offtopic:"manual",filler:"manual"}}}async fetchSponsorSegments(e){try{this.cleanupVideoElements();const t=await fetch(`https://sponsor.ajay.app/api/skipSegments?videoID=${e}`),n=await t.text();if(!n||""===n.trim()||"[]"===n.trim())return this.videoManager.showNotification("No segment found","warning"),void(this.sponsorSegments=[]);const i=JSON.parse(n);if(!i||!Array.isArray(i)||0===i.length)return this.videoManager.showNotification("No segment found","warning"),void(this.sponsorSegments=[]);if(this.sponsorSegments=i.filter(e=>["sponsor","selfpromo","interaction","intro","outro","preview","music_offtopic","filler"].includes(e.category)).map(e=>({start:e.segment[0],end:e.segment[1],type:e.category,videoDuration:e.videoDuration})),0===this.sponsorSegments.length)return void this.videoManager.showNotification("No segment found","warning");this.updateWatchableDuration(),this.videoManager.showNotification(`Segmen sponsor terdeteksi: ${JSON.stringify(this.sponsorSegments)}`,"success"),this.highlightSponsorSegments(),this.highlightPendingSegments()}catch(e){this.sponsorSegments=[],this.videoManager.showNotification("Error fetching sponsor segments","error")}}updateWatchableDuration(){const e=this.sponsorSegments[0]?.videoDuration;if(!e)return;const t=e-this.sponsorSegments.reduce((e,t)=>e+(t.end-t.start),0),n=YouTubeUtils.getElement(".ytp-time-duration");if(n){const e=n.parentElement,i=e.querySelector(".ytp-time-watchable-container");i&&i.remove();const a=document.createElement("span");a.className="ytp-time-watchable-container";const s=Math.floor(t/60),o=Math.floor(t%60);a.innerHTML=`<span class="ytp-time-watchable">(${s.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")})</span>`,e.appendChild(a)}}async highlightSponsorSegments(){const e=await YouTubeUtils.waitForElement(".ytp-progress-list"),t=await YouTubeUtils.waitForElement("video");if(!e||!t)return;YouTubeUtils.getElements(".sponsor-segment-highlight:not(.pending-segment-highlight)").forEach(e=>e.remove());const n=t.duration;if(!n)return;const i=YouTubeUtils.getElements(".ytp-chapter-hover-container");this.sponsorSegments.forEach(a=>{let s=e,o=a.start/n*100,r=(a.end-a.start)/n*100;if(i.length>0){let e=0,l=!1;for(let d of i){const i=parseFloat(d.style.width)/t.offsetWidth*100,u=(e+i)*n/100,c=e*n/100;if(a.start>=c&&a.start<u){s=d.querySelector(".ytp-progress-list"),o=(a.start-c)/(u-c)*100,r=Math.min((a.end-a.start)/(u-c)*100,100-o),l=!0;break}e+=i}if(l&&r>=100){const s=a.end-e*n/100;if(s>0){const o=i[Math.floor(e/(100/i.length))+1];if(o){const e=o.querySelector(".ytp-progress-list"),i=parseFloat(o.style.width)/t.offsetWidth*100*n/100;this.createHighlight(e,0,s/i*100,a.type)}}}}this.createHighlight(s,o,r,a.type)})}async highlightPendingSegments(){const e=await YouTubeUtils.waitForElement(".ytp-progress-list"),t=await YouTubeUtils.waitForElement("video");if(!e||!t)return;YouTubeUtils.getElements(".pending-segment-highlight").forEach(e=>e.remove());const n=t.duration;if(!n)return;const i=YouTubeUtils.getElements(".ytp-chapter-hover-container");this.pendingSegments.forEach(a=>{let s=e,o=a.startTime/n*100,r=(a.endTime-a.startTime)/n*100;if(i.length>0){let e=0,l=!1;for(let d of i){const i=parseFloat(d.style.width)/t.offsetWidth*100,u=(e+i)*n/100,c=e*n/100;if(a.startTime>=c&&a.startTime<u){s=d.querySelector(".ytp-progress-list"),o=(a.startTime-c)/(u-c)*100,r=Math.min((a.endTime-a.startTime)/(u-c)*100,100-o),l=!0;break}e+=i}if(l&&r>=100){const s=a.endTime-e*n/100;if(s>0){const a=i[Math.floor(e/(100/i.length))+1];if(a){const e=a.querySelector(".ytp-progress-list"),i=parseFloat(a.style.width)/t.offsetWidth*100*n/100;this.createPendingHighlight(e,0,s/i*100)}}}}this.createPendingHighlight(s,o,r)})}createHighlight(e,t,n,i){const a=document.createElement("div");a.className="sponsor-segment-highlight",a.setAttribute("data-segment-type",i),a.style.left=`${t}%`,a.style.width=`${n}%`,e.appendChild(a)}createPendingHighlight(e,t,n){const i=document.createElement("div");i.className="sponsor-segment-highlight pending-segment-highlight",i.setAttribute("data-segment-type","pending"),i.style.left=`${t}%`,i.style.width=`${n}%`,e.appendChild(i)}async addSubmitButton(){const e=await YouTubeUtils.waitForElement(".ytp-right-controls");if(e&&!YouTubeUtils.getElement(".submit-segment-button")){const t=document.createElement("button");t.className="ytp-button submit-segment-button",t.title="Submit Sponsor Segment",t.innerHTML='<img style="width: 3rem;" src="https://sponsor.ajay.app/LogoSponsorBlockSimple256px.png"></img>',t.setAttribute("data-priority","4");e.querySelector(".ytp-subtitles-button")?e.insertAdjacentElement("afterbegin",t):e.appendChild(t)}}async setupSubmitSegmentListeners(e){const t={submitButton:await YouTubeUtils.waitForElement(".submit-segment-button"),submitPopover:await YouTubeUtils.waitForElement("#submit-segment-popover"),startSegmentButton:await YouTubeUtils.waitForElement("#start-segment-button"),endSegmentButton:await YouTubeUtils.waitForElement("#end-segment-button"),manageSegmentsButton:await YouTubeUtils.waitForElement("#manage-segments-button"),submitPopup:await YouTubeUtils.waitForElement("#submit-popup"),submitAllButton:await YouTubeUtils.waitForElement("#submit-all-button"),submitCancelButton:await YouTubeUtils.waitForElement("#submit-cancel-button"),pendingSegmentsList:await YouTubeUtils.waitForElement("#pending-segments-list")},n=()=>{t.submitPopup.style.display="none"},i=()=>{t.pendingSegmentsList.innerHTML=this.pendingSegments.length>0?this.pendingSegments.map((e,t)=>`\n            <div class="pending-segment" title="segment-${t+1}">\n              <div class="pending-segment-inner">\n                <span>Segment ${t+1}: ${YouTubeUtils.getFormattedTime(e.startTime)} - ${YouTubeUtils.getFormattedTime(e.endTime)} (${e.category})</span>\n              </div>\n              <button class="remove-segment-btn" data-index="${t}">Remove</button>\n            </div>\n          `).join(""):'<p style="font-size: 14px;">No segments added yet.</p>',YouTubeUtils.getElements(".remove-segment-btn").forEach(e=>{e.addEventListener("click",()=>{const t=parseInt(e.getAttribute("data-index"));this.pendingSegments.splice(t,1),i(),this.highlightPendingSegments(),this.videoManager.showNotification(`Segment ${t+1} removed`,"info")})})},a=(()=>{const e=document.createElement("div");return e.id="category-input-popup",e.className="popup",e.style.display="none",e.innerHTML=`\n        <div class="popup-content">\n          <h3 class="popup-heading">Set Segment Category</h3>\n          <div class="popup-list">\n            <div class="form-group">\n              <label for="segment-category-input">Category</label>\n              <select id="segment-category-input">\n                ${Object.keys(this.skipSettings).map(e=>`\n                  <option value="${e}">${this.getSegmentTypeLabel(e)}</option>\n                `).join("")}\n              </select>\n            </div>\n          </div>\n          <div class="popup-buttons">\n            <button id="category-cancel-button" class="close-btn">Cancel</button>\n            <button id="category-save-button" class="submit-btn">Save</button>\n          </div>\n        </div>\n      `,document.body.appendChild(e),e})(),s={popup:a,categorySelect:a.querySelector("#segment-category-input"),saveButton:a.querySelector("#category-save-button"),cancelButton:a.querySelector("#category-cancel-button")};t.submitButton?.addEventListener("click",n=>{n.stopPropagation(),e.hideAllPopups(),"block"===t.submitPopover.style.display?t.submitPopover.style.display="none":t.submitPopover.style.display="block"}),document.addEventListener("keydown",e=>{"Escape"===e.key&&"block"===t.submitPopup?.style.display&&n(),"Escape"===e.key&&"block"===s.popup.style.display&&(s.popup.style.display="none",t.startSegmentButton.disabled=!1,t.endSegmentButton.disabled=!0,this.segmentStartTime=null)}),t.startSegmentButton?.addEventListener("click",async()=>{const e=await YouTubeUtils.waitForElement("video");e&&(this.segmentStartTime=e.currentTime,this.videoManager.showNotification(`Start time set to ${YouTubeUtils.getFormattedTime(this.segmentStartTime)}`,"info"),t.startSegmentButton.disabled=!0,t.endSegmentButton.disabled=!1)}),t.endSegmentButton?.addEventListener("click",async()=>{const n=await YouTubeUtils.waitForElement("video");if(n&&null!==this.segmentStartTime){const a=n.currentTime;if(a<=this.segmentStartTime)return void this.videoManager.showNotification("Waktu selesai harus lebih besar dari waktu mulai","error");e.hideAllPopups(),s.popup.style.display="block",t.endSegmentButton.disabled=!0;const o=()=>{const e=s.categorySelect.value;YouTubeUtils.getIsValidSegmentData({startTime:this.segmentStartTime,endTime:a,category:e})?(this.pendingSegments.push({startTime:this.segmentStartTime,endTime:a,category:e,title:`segment-${this.pendingSegments.length+1}`}),this.videoManager.showNotification(`Segment ${this.pendingSegments.length} added to pending list`,"success"),this.highlightPendingSegments(),this.segmentStartTime=null,t.startSegmentButton.disabled=!1,t.endSegmentButton.disabled=!0,i(),s.popup.style.display="none"):this.videoManager.showNotification("Data segment tidak valid","error")};s.saveButton.onclick=o(),s.cancelButton.onclick=()=>{s.popup.style.display="none",t.startSegmentButton.disabled=!1,t.endSegmentButton.disabled=!0,this.segmentStartTime=null}}}),t.manageSegmentsButton?.addEventListener("click",()=>{e.hideAllPopups(),t.submitPopup.style.display="block",i()}),t.submitCancelButton?.addEventListener("click",n),t.submitPopup?.addEventListener("click",e=>{e.target===t.submitPopup&&n()}),t.submitAllButton?.addEventListener("click",async()=>{if(0!==this.pendingSegments.length)try{await this.submitSponsorSegment(YouTubeUtils.getCurrentVideoId()),this.videoManager.showNotification(`Successfully submitted ${this.pendingSegments.length} segments!`,"success"),this.pendingSegments=[],i(),this.highlightPendingSegments(),n()}catch(e){this.videoManager.showNotification(`Failed to submit segments: ${e.message}`,"error")}else this.videoManager.showNotification("No segments to submit","warning")})}async submitSponsorSegment(e){try{const t=YouTubeUtils.getVideoDuration(),n={videoID:e,userID:YouTubeUtils.getOrCreateUserID(),userAgent:"YouTube-Fixed-Extension/1.0.0",service:"YouTube",videoDuration:t,segments:this.pendingSegments.map(e=>({segment:[e.startTime,e.endTime],category:e.category,actionType:"skip"}))},i=await fetch("https://sponsor.ajay.app/api/skipSegments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!i.ok){const e=await i.json().catch(()=>({}));throw new Error(e.message||`HTTP error! status: ${i.status}`)}return await i.json()}catch(e){throw console.error("❌ Error submitting segments:",e),e}}showSkipButton(e,t){this.skipButton||(this.skipButton=document.createElement("button"),this.skipButton.className="sponsor-skip-button",this.skipButton.onclick=()=>this.skipCurrentSegment(e),YouTubeUtils.getElement(".html5-video-player").appendChild(this.skipButton)),this.skipButton.innerHTML=`(Enter) Skip ${this.getSegmentTypeLabel(t.type)}`,this.skipButton.style.display="flex"}hideSkipButton(){this.skipButton&&(this.skipButton.style.display="none")}skipCurrentSegment(e){this.currentSponsorSegment&&(e.currentTime=this.currentSponsorSegment.end,this.currentSponsorSegment=null,this.hideSkipButton())}getSegmentTypeLabel(e){return{sponsor:"Sponsor",selfpromo:"Promosi",interaction:"Interaksi",intro:"Intro",outro:"Outro",preview:"Preview",music_offtopic:"Musik/Offtopic",filler:"Filler"}[e]||"Segmen"}cleanupVideoElements(){this.sponsorSegments=[],this.currentSponsorSegment=null,this.pendingSegments=[],this.segmentStartTime=null,this.skipButton&&(this.skipButton.remove(),this.skipButton=null);YouTubeUtils.getElements(".sponsor-segment-highlight").forEach(e=>e.remove());const e=YouTubeUtils.getElement(".ytp-time-watchable-container");e&&e.remove()}}class UIManager{constructor(e,t){this.videoManager=e,this.sponsorSegmentManager=t}hideAllPopups(){YouTubeUtils.getElements(".popup").forEach(e=>{e.style.display="none"});const e=YouTubeUtils.getElement("#settings-popover");e&&(e.style.display="none")}async updateHeader(){YouTubeUtils.getElements("#logo-icon > span").forEach(e=>{if(!e.shadowRoot){e.attachShadow({mode:"open"}).innerHTML='\n          <div injected style="width: 100%; height: 100%; display: block; fill: currentcolor;">\n            <svg xmlns="http://www.w3.org/2000/svg" id="yt-ringo2-red-svg_yt196" class="external-icon" width="101" height="20" viewBox="0 0 101 20" focusable="false" aria-hidden="true" style="pointer-events: none; display: inherit; width: 100%; height: 100%;">\n              <g>\n                <path d="M14.4848 20C14.4848 20 23.5695 20 25.8229 19.4C27.0917 19.06 28.0459 18.08 28.3808 16.87C29 14.65 29 9.98 29 9.98C29 9.98 29 5.34 28.3808 3.14C28.0459 1.9 27.0917 0.94 25.8229 0.61C23.5695 0 14.4848 0 14.4848 0C14.4848 0 5.42037 0 3.17711 0.61C1.9286 0.94 0.954148 1.9 0.59888 3.14C0 5.34 0 9.98 0 9.98C0 9.98 0 14.65 0.59888 16.87C0.954148 18.08 1.9286 19.06 3.17711 19.4C5.42037 20 14.4848 20 14.4848 20Z" fill="#FF0033"></path>\n                <path d="M19 10L11.5 5.75V14.25L19 10Z" fill="white"></path>\n              </g>\n              <g id="youtube-paths_yt196">\n                <path d="M32.1819 2.10016V18.9002H34.7619V12.9102H35.4519C38.8019 12.9102 40.5619 11.1102 40.5619 7.57016V6.88016C40.5619 3.31016 39.0019 2.10016 35.7219 2.10016H32.1819ZM37.8619 7.63016C37.8619 10.0002 37.1419 11.0802 35.4019 11.0802H34.7619V3.95016H35.4519C37.4219 3.95016 37.8619 4.76016 37.8619 7.13016V7.63016Z"></path>\n                <path d="M41.982 18.9002H44.532V10.0902C44.952 9.37016 45.992 9.05016 47.302 9.32016L47.462 6.33016C47.292 6.31016 47.142 6.29016 47.002 6.29016C45.802 6.29016 44.832 7.20016 44.342 8.86016H44.162L43.952 6.54016H41.982V18.9002Z"></path>\n                <path d="M55.7461 11.5002C55.7461 8.52016 55.4461 6.31016 52.0161 6.31016C48.7861 6.31016 48.0661 8.46016 48.0661 11.6202V13.7902C48.0661 16.8702 48.7261 19.1102 51.9361 19.1102C54.4761 19.1102 55.7861 17.8402 55.6361 15.3802L53.3861 15.2602C53.3561 16.7802 53.0061 17.4002 51.9961 17.4002C50.7261 17.4002 50.6661 16.1902 50.6661 14.3902V13.5502H55.7461V11.5002ZM51.9561 7.97016C53.1761 7.97016 53.2661 9.12016 53.2661 11.0702V12.0802H50.6661V11.0702C50.6661 9.14016 50.7461 7.97016 51.9561 7.97016Z"></path>\n                <path d="M60.1945 18.9002V8.92016C60.5745 8.39016 61.1945 8.07016 61.7945 8.07016C62.5645 8.07016 62.8445 8.61016 62.8445 9.69016V18.9002H65.5045L65.4845 8.93016C65.8545 8.37016 66.4845 8.04016 67.1045 8.04016C67.7745 8.04016 68.1445 8.61016 68.1445 9.69016V18.9002H70.8045V9.49016C70.8045 7.28016 70.0145 6.27016 68.3445 6.27016C67.1845 6.27016 66.1945 6.69016 65.2845 7.67016C64.9045 6.76016 64.1545 6.27016 63.0845 6.27016C61.8745 6.27016 60.7345 6.79016 59.9345 7.76016H59.7845L59.5945 6.54016H57.5445V18.9002H60.1945Z"></path>\n                <path d="M74.0858 4.97016C74.9858 4.97016 75.4058 4.67016 75.4058 3.43016C75.4058 2.27016 74.9558 1.91016 74.0858 1.91016C73.2058 1.91016 72.7758 2.23016 72.7758 3.43016C72.7758 4.67016 73.1858 4.97016 74.0858 4.97016ZM72.8658 18.9002H75.3958V6.54016H72.8658V18.9002Z"></path>\n                <path d="M79.9516 19.0902C81.4116 19.0902 82.3216 18.4802 83.0716 17.3802H83.1816L83.2916 18.9002H85.2816V6.54016H82.6416V16.4702C82.3616 16.9602 81.7116 17.3202 81.1016 17.3202C80.3316 17.3202 80.0916 16.7102 80.0916 15.6902V6.54016H77.4616V15.8102C77.4616 17.8202 78.0416 19.0902 79.9516 19.0902Z"></path>\n                <path d="M90.0031 18.9002V8.92016C90.3831 8.39016 91.0031 8.07016 91.6031 8.07016C92.3731 8.07016 92.6531 8.61016 92.6531 9.69016V18.9002H95.3131L95.2931 8.93016C95.6631 8.37016 96.2931 8.04016 96.9131 8.04016C97.5831 8.04016 97.9531 8.61016 97.9531 9.69016V18.9002H100.613V9.49016C100.613 7.28016 99.8231 6.27016 98.1531 6.27016C96.9931 6.27016 96.0031 6.69016 95.0931 7.67016C94.7131 6.76016 93.9631 6.27016 92.8931 6.27016C91.6831 6.27016 90.5431 6.79016 89.7431 7.76016H89.5931L89.4031 6.54016H87.3531V18.9002H90.0031Z"></path>\n              </g>\n            </svg>\n          </div>\n        '}});const e={"a.ytd-topbar-logo-renderer":e=>e.removeAttribute("href"),"ytd-topbar-logo-renderer#logo":e=>e.removeAttribute("show-yoodle"),"a#logo.ytd-topbar-logo-renderer>div.ytd-topbar-logo-renderer":e=>e.removeAttribute("hidden"),"#country-code.ytd-topbar-logo-renderer":e=>e.removeAttribute("hidden"),"#logo.ytd-topbar-logo-renderer":e=>e.setAttribute("title","Beranda YouTube Premium")};for(const[t,n]of Object.entries(e))YouTubeUtils.getElements(t).forEach(n)}async renderClock(){const e=YouTubeUtils.getElement("#end");if(!e)return;const t=YouTubeUtils.getElement("div.header-clock");t?.remove();const n=()=>{const e=new Date,t=YouTubeUtils.getElement(".header-clock .clock-digits:nth-child(1)"),i=YouTubeUtils.getElement(".header-clock .clock-digits:nth-child(3)");t&&i&&(t.innerHTML=e.getHours().toString().padStart(2,"0"),i.innerHTML=e.getMinutes().toString().padStart(2,"0")),requestAnimationFrame(n)},i=document.createElement("div");i.className="header-clock",i.innerHTML=`\n      <div class="clock-digits">${(new Date).getHours().toString().padStart(2,"0")}</div>\n      <span>:</span>\n      <div class="clock-digits">${(new Date).getMinutes().toString().padStart(2,"0")}</div>\n    `,e.insertAdjacentElement("afterbegin",i),n()}createSkipSettingsPopup(){const e=document.createElement("div");e.id="skip-popup",e.className="popup",e.style.display="none",e.innerHTML=`\n      <div class="popup-content">\n        <h3 class="popup-heading">Pengaturan Skip Sponsor</h3>\n        <div class="popup-list">\n          ${Object.keys(this.sponsorSegmentManager.skipSettings).map(e=>`\n            <div class="form-group">\n              <label>${this.sponsorSegmentManager.getSegmentTypeLabel(e)}</label>\n              <select data-type="${e}">\n                <option value="manual" ${"manual"===this.sponsorSegmentManager.skipSettings[e]?"selected":""}>Manual</option>\n                <option value="auto" ${"auto"===this.sponsorSegmentManager.skipSettings[e]?"selected":""}>Otomatis</option>\n              </select>\n            </div>\n          `).join("")}\n        </div>\n        <div class="popup-buttons">\n          <button id="skip-close-button" class="close-btn">Tutup</button>\n          <button id="skip-save-button" class="save-btn">Simpan</button>\n        </div>\n      </div>\n    `,document.body.appendChild(e)}createSubmitSegmentPopup(){const e=document.createElement("div");e.id="submit-popup",e.className="popup",e.style.display="none",e.innerHTML='\n      <div class="popup-content">\n        <h3 class="popup-heading">Manage Sponsor Segments</h3>\n        <div class="pending-segments">\n          <h1>Pending Segments</h1>\n          <div id="pending-segments-list"></div>\n        </div>\n        <div class="popup-buttons">\n          <button id="submit-cancel-button" class="close-btn">Cancel</button>\n          <button id="submit-all-button" class="submit-btn">Submit All</button>\n        </div>\n      </div>\n    ',document.body.appendChild(e)}createSubmitSegmentPopover(){const e=document.createElement("div");e.id="submit-segment-popover",e.className="submit-segment-popover",e.style.display="none",e.innerHTML='\n      <div class="popover-content">\n        <button id="start-segment-button" class="style-scope start-segment" title="Start Segment">\n          <svg xmlns="http://www.w3.org/2000/svg" width="1.6em" height="1.6em" viewBox="0 0 24 24">\n            <path fill="white" d="M8 5v14l11-7z"/>\n          </svg>\n        </button>\n        <button id="end-segment-button" class="style-scope end-segment" title="End Segment" disabled>\n          <svg xmlns="http://www.w3.org/2000/svg" width="1.6em" height="1.6em" viewBox="0 0 24 24">\n            <path fill="white" d="M6 18V6h4v12zm8 0V6h4v12z"/>\n          </svg>\n        </button>\n        <button id="manage-segments-button" class="style-scope manage-segments" title="Manage Segments">\n          <svg xmlns="http://www.w3.org/2000/svg" width="1.6em" height="1.6em" viewBox="0 0 24 24">\n            <path fill="white" d="M3 17v2h6v-2zm0-5v2h9v-2zm0-5v2h12v-2z"/>\n          </svg>\n        </button>\n      </div>\n    ',document.body.appendChild(e)}createFetchPopup(){const e=document.createElement("div");e.id="fetch-popup",e.className="popup",e.style.display="none",e.innerHTML=`\n      <div class="popup-content">\n        <h3 class="popup-heading">Custom Fetch Configuration</h3>\n        <div class="popup-form">\n          <div class="form-group">\n            <label for="fetch-input">Fetch URL<span id="url-validation-message">*Invalid Fetch</span></label>\n            <input type="text" id="fetch-input" placeholder="Enter fetch URL..." autocomplete="off">\n          </div>\n          <div class="form-group">\n            <label for="fetch-interval">Interval (ms)<span id="interval-validation-message">*Invalid number</span></label>\n            <input type="number" id="fetch-interval" placeholder="Enter interval..." value="${localStorage.getItem("fetchInterval")||""}">\n          </div>\n        </div>\n        <div class="popup-buttons">\n          <button id="fetch-close-button" class="close-btn">Close</button>\n          <button id="fetch-submit-button" class="submit-btn">Start Fetch</button>\n          <button id="fetch-stop-button" class="stop-btn" style="display: none;">Stop Fetch</button>\n        </div>\n      </div>\n    `,document.body.appendChild(e)}createExtendedSettingsPopup(){const e=document.createElement("div");e.id="extended-popup",e.className="popup",e.style.display="none",e.innerHTML=`\n      <div class="popup-content">\n        <h3 class="popup-heading">YouTube Extended Settings</h3>\n        <div class="popup-list">\n          <div class="form-group">\n            <label>Looping</label>\n            <select id="yt-loop-select">\n              <option value="false" ${!1===this.videoManager.loopState?"selected":""}>Off</option>\n              <option value="true" ${!0===this.videoManager.loopState?"selected":""}>On</option>\n            </select>\n          </div>\n          <div class="form-group">\n            <label>Bass Boost</label>\n            <select data-key="bassBoost">\n              <option value="false" ${this.videoManager.isBassBoosted?"":"selected"}>Off</option>\n              <option value="true" ${this.videoManager.isBassBoosted?"selected":""}>On</option>\n            </select>\n          </div>\n          <div class="form-group">\n            <label>Default Subtitles</label>\n            <input type="text" id="default-subtitle" placeholder="Enter default subtitle" autocomplete="off" value="${this.videoManager.defaultSubtitle}">\n          </div>\n        </div>\n        <div class="popup-buttons">\n          <button id="extended-close-button" class="close-btn">Close</button>\n          <button id="extended-save-button" class="save-btn">Save</button>\n        </div>\n      </div>\n    `,document.body.appendChild(e)}createSettingsPopover(){const e=document.createElement("div");e.id="settings-popover",e.className="settings-popover",e.style.display="none",e.innerHTML='\n      <div class="popover-content">\n        <button id="toggle-fetch-input" class="style-scope toggle-fetch" title="Spam Web Request">\n          <svg xmlns="http://www.w3.org/2000/svg" width="1.6em" height="1.6em" viewBox="0 0 14 14">\n            <path fill="none" stroke="white" stroke-linecap="round" stroke-linejoin="round" d="m.5 10.5l10-10H6m7.5 3l-10 10H8" />\n          </svg>\n          <span>Spam Web Request</span>\n        </button>\n        <button id="toggle-skip-settings" class="style-scope toggle-skip-settings" title="Atur Skip Sponsor">\n          <img style="width: 2.5rem;" src="https://sponsor.ajay.app/LogoSponsorBlockSimple256px.png">\n          <span>Atur Skip Sponsor</span>\n        </button>\n        <button id="toggle-extended-settings" class="style-scope toggle-extended-settings" title="Extended Settings">\n          <svg width="2.5rem" viewBox="0 0 24 24" fill="#FFFF00" xmlns="http://www.w3.org/2000/svg">\n            <path d="M4 19H20M4 5V16H20V5L16 9L12 5L8 9L4 5Z" stroke="#FFFF00" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n          </svg>\n          <span>Extended Settings</span>\n        </button>\n      </div>\n    ',document.body.appendChild(e)}setupToolbarButtons(){const e=YouTubeUtils.getElement("#end");if(!e||YouTubeUtils.getElement("#toggle-all-settings"))return;const t=document.createElement("button");t.id="toggle-all-settings",t.className="style-scope toggle-all-settings",t.setAttribute("title","All Settings"),t.innerHTML='\n      <svg width="2.5rem" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path d="M12 2L14.472 8.05097C14.7277 8.61734 15.2673 9.00802 15.8926 9.06939L22.5 9.75L17.8437 14.2584C17.4061 14.6848 17.1964 15.2836 17.2792 15.8766L18.0938 22.4531L12.4297 19.7266C11.8809 19.4605 11.241 19.4605 10.6922 19.7266L5.02812 22.4531L5.84268 15.8766C5.92549 15.2836 5.71585 14.6848 5.27825 14.2584L0.621875 9.75L7.22946 9.06939C7.85467 9.00802 8.3943 8.61734 8.64995 8.05097L11.122 2H12Z" fill="#FFD700" stroke="#FFD700" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>\n      </svg>\n    ',e.insertAdjacentElement("afterbegin",t),this.createSettingsPopover(),this.createSkipSettingsPopup(),this.createSubmitSegmentPopup(),this.createSubmitSegmentPopover(),this.createFetchPopup(),this.createExtendedSettingsPopup(),this.setupAllSettingsListener(),this.setupSkipSettingsListeners(),this.setupFetchPopupListeners(),this.setupExtendedSettingsListener()}setupAllSettingsListener(){const e=YouTubeUtils.getElement("#toggle-all-settings"),t=YouTubeUtils.getElement("#settings-popover");e?.addEventListener("click",e=>{e.stopPropagation(),this.hideAllPopups(),t.style.display="none"===t.style.display?"block":"none"}),document.addEventListener("click",n=>{"block"!==t?.style.display||t.contains(n.target)||n.target===e||(t.style.display="none")}),document.addEventListener("keydown",e=>{"Escape"===e.key&&"block"===t?.style.display&&(t.style.display="none")})}setupSkipSettingsListeners(){const e={skipSettingsPopup:YouTubeUtils.getElement("#skip-popup"),toggleSkipSettingsButton:YouTubeUtils.getElement("#toggle-skip-settings"),saveSkipSettingsButton:YouTubeUtils.getElement("#skip-save-button"),closeSkipSettingsButton:YouTubeUtils.getElement("#skip-close-button"),skipSettingSelects:YouTubeUtils.getElements("#skip-popup .popup-list select")};e.toggleSkipSettingsButton?.addEventListener("click",()=>{this.hideAllPopups(),e.skipSettingsPopup.style.display="block"}),e.closeSkipSettingsButton?.addEventListener("click",()=>{e.skipSettingsPopup.style.display="none"}),e.skipSettingsPopup?.addEventListener("click",t=>{t.target===e.skipSettingsPopup&&(e.skipSettingsPopup.style.display="none")}),e.saveSkipSettingsButton?.addEventListener("click",()=>{const t=this.sponsorSegmentManager.loadSkipSettings();e.skipSettingSelects.forEach(e=>{t[e.getAttribute("data-type")]=e.value}),localStorage.setItem("skipSettings",JSON.stringify(t)),this.sponsorSegmentManager.skipSettings=t,e.skipSettingsPopup.style.display="none",this.videoManager.showNotification(`Settings saved: ${Object.entries(t).map(([e,t])=>`${e}: ${t}`).join(", ")}`,"success")}),document.addEventListener("keydown",t=>{"Escape"===t.key&&"block"===e.skipSettingsPopup.style.display&&(e.skipSettingsPopup.style.display="none")})}setupFetchPopupListeners(){const e={fetchPopup:YouTubeUtils.getElement("#fetch-popup"),fetchInput:YouTubeUtils.getElement("#fetch-input"),fetchIntervalInput:YouTubeUtils.getElement("#fetch-interval"),submitFetchButton:YouTubeUtils.getElement("#fetch-submit-button"),stopFetchButton:YouTubeUtils.getElement("#fetch-stop-button"),closePopupButton:YouTubeUtils.getElement("#fetch-close-button"),toggleFetchButton:YouTubeUtils.getElement("#toggle-fetch-input"),urlMessage:YouTubeUtils.getElement("#url-validation-message"),intervalMessage:YouTubeUtils.getElement("#interval-validation-message")};let t=null;const n=t=>{e.stopFetchButton.style.display=t?"inline-block":"none",e.submitFetchButton.style.display=t?"none":"inline-block"};e.toggleFetchButton?.addEventListener("click",()=>{this.hideAllPopups(),e.fetchPopup.style.display="block"}),e.closePopupButton?.addEventListener("click",()=>{e.fetchPopup.style.display="none"}),e.fetchPopup?.addEventListener("click",t=>{t.target===e.fetchPopup&&(e.fetchPopup.style.display="none")}),e.submitFetchButton?.addEventListener("click",()=>{const i=e.fetchInput.value.trim(),a=e.fetchIntervalInput.value;((t,n)=>{const i=/^fetch.*https:\/\//.test(t),a=/^\d+$/.test(n)&&parseInt(n,10)>0;return e.urlMessage.style.display=i?"none":"block",e.intervalMessage.style.display=a?"none":"block",i&&a})(i,a)&&(localStorage.setItem("spamInterval",a),((e,i)=>{t&&clearInterval(t),t=setInterval(()=>{try{new Function(e)()}catch(e){console.error("Error executing fetch code:",e)}},parseInt(i)),n(!0)})(i,a))}),e.stopFetchButton?.addEventListener("click",()=>{t&&(clearInterval(t),t=null,n(!1))})}setupExtendedSettingsListener(){const e=YouTubeUtils.getElement("#extended-popup"),t=YouTubeUtils.getElement("#toggle-extended-settings"),n=YouTubeUtils.getElement("#extended-close-button"),i=YouTubeUtils.getElement("#extended-save-button");t.addEventListener("click",()=>{this.hideAllPopups(),e.style.display="block"}),e.addEventListener("click",t=>{t.target===e&&(e.style.display="none")}),document.addEventListener("keydown",t=>{"Escape"===t.key&&"block"===e.style.display&&(e.style.display="none")}),n.onclick=()=>e.style.display="none",i.onclick=()=>{this.videoManager.loopState="true"===YouTubeUtils.getElement("#yt-loop-select").value,localStorage.setItem("loopState",this.videoManager.loopState),this.videoManager.applyVideoState(),this.videoManager.isBassBoosted="true"===YouTubeUtils.getElements('#extended-popup select[data-key="bassBoost"]')[0].value,localStorage.setItem("bassBoost",this.videoManager.isBassBoosted),this.videoManager.applyBassBoostState();const t=YouTubeUtils.getElement("#default-subtitle").value;this.videoManager.defaultSubtitle=this.getCountryId(t)||"id",localStorage.setItem("defaultSubtitleValue",this.videoManager.defaultSubtitle),this.videoManager.applySubtitleState(),e.style.display="none",this.videoManager.showNotification(`Settings saved: Looping: ${this.videoManager.loopState}, Bass Boosted: ${this.videoManager.isBassBoosted}, Default Subtitle: ${this.videoManager.defaultSubtitle}`,"success")}}getCountryId(e){if(!e||"string"!=typeof e)return this.videoManager.showNotification(`Country ${e} invalid`,"error"),null;const t=e.toLowerCase().trim(),n=SUPPORTED_LANGUAGES.find(e=>e.id.toLowerCase()===t||e.name.toLowerCase()===t);return n?n.id.toLowerCase():(this.videoManager.showNotification(`Country '${e}' not found`,"error"),null)}}class YouTubeEnhancer{constructor(){this.videoManager=new VideoManager,this.uiManager=new UIManager(this.videoManager,null),this.sponsorSegmentManager=new SponsorSegmentManager(this.videoManager,this.uiManager),this.uiManager.sponsorSegmentManager=this.sponsorSegmentManager,this.lastDateText="Dipublikasikan baru saja",this.setupEventListeners()}async init(){document.body?(await YouTubeUtils.waitForElement("#logo-icon > span").then(()=>this.uiManager.updateHeader()),await YouTubeUtils.waitForElement("#logo-icon > span > div").then(()=>this.uiManager.setupToolbarButtons()),await YouTubeUtils.waitForElement("#end").then(()=>this.uiManager.renderClock()),"/watch"===location.pathname&&await this.watch(),this.watchUrlChange()):requestAnimationFrame(()=>this.init())}async watch(){const e=YouTubeUtils.getCurrentVideoId();this.sponsorSegmentManager.cleanupVideoElements(),this.videoManager.fetchVideoData(e);await YouTubeUtils.waitForElement("#movie_player")&&await YouTubeUtils.waitForVideoData("video").then(()=>{console.log("video is ready"),this.videoManager.monitorResolutionChange(),this.videoManager.setHighestResolution(),this.videoManager.applyVideoState(),this.videoManager.applySubtitleState(),this.videoManager.applyBassBoostState()}),this.sponsorSegmentManager.initializeSponsorSkip(),this.interceptFetch()}watchUrlChange(){let e=location.href;const t=()=>{location.href!==e?(e=location.href,this.uiManager.hideAllPopups(),this.sponsorSegmentManager.cleanupVideoElements(),this.init()):requestAnimationFrame(t)};t()}setupEventListeners(){window.addEventListener("beforeunload",()=>{this.videoManager.savePlaybackPosition(),this.videoManager.audioNode=null,this.videoManager.lastLoggedViewCount=null,this.videoManager.countdownInterval&&(clearInterval(this.videoManager.countdownInterval),this.videoManager.countdownInterval=null)})}interceptFetch(){const e=window.fetch;window.fetch=async(t,n)=>{const i="string"==typeof t?t:t.url,a=await e(t,n);if(i.includes("/youtubei/v1/updated_metadata")){const e=a.clone(),t=await e.json(),n=this.handleUpdatedMetadataRequest(i,t);n&&n.viewership?.rawCount&&this.videoManager.updateViewDisplay(n.viewership.rawCount,n.isLive,!1,n.dateText)}return a}}handleUpdatedMetadataRequest(e,t){if(!e.includes("/youtubei/v1/updated_metadata"))return null;try{const e="string"==typeof t?JSON.parse(t):t;if(!e.actions||!Array.isArray(e.actions))return null;let n={viewership:null,dateText:null,isLive:!1};return e.actions.forEach(e=>{if(e.updateViewershipAction){const t=e.updateViewershipAction.viewCount?.videoViewCountRenderer;if(n.isLive=!!t?.isLive,t){const i=t?.viewCount?.simpleText||null,a=i?i.split(" ")[0].replace(/[,.]/g,""):null;n.viewership={raw:e.updateViewershipAction,displayText:a?this.videoManager.getFormattedViewCount(a,n.isLive,!1):null,rawCount:a}}}if(e.updateDateTextAction){const t=e.updateDateTextAction.dateText?.simpleText;t&&(n.dateText=YouTubeUtils.getRelativeDateText(t),this.lastDateText=YouTubeUtils.getRelativeDateText(t))}}),n.dateText||(n.dateText=this.lastDateText),n.viewership?n:null}catch(e){return console.error("Failed to parse updated_metadata subclause:",e.message),null}}}const enhancer=new YouTubeEnhancer;enhancer.init();